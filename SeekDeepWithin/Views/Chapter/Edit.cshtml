@model SeekDeepWithin.Models.ChapterViewModel
@section styles {@Styles.Render("~/Content/css/slider")}
@{
   var title = Model.SubBook.Version.Title;
   if (!Model.SubBook.Hide)
   {
      title += " | " + Model.SubBook.Name;
   }
   title += " | " + Model.Name;
   ViewBag.Title = "Editing " + title;
   var scheme = Request.Url == null ? string.Empty : Request.Url.Scheme;
}
@section featured {
   <div class="panel tCenter">
      <a href="@Url.Action("Edit", "Version", new {id=Model.SubBook.Version.Id}, scheme)" class="sdw-button reg">
         <small>version</small> @(Model.SubBook.Version.Title)
      </a>
      <a href="@Url.Action("Edit", "SubBook", new {id=Model.SubBook.Id}, scheme)" class="sdw-button reg">
         <small>sub book</small> @(Model.SubBook.Name)
      </a>
      <a href="@Url.Action("Index", "Read", new {id=Model.Id}, scheme)" class="sdw-button reg">
         <small>read</small> @(Model.Name)
      </a>
   </div>
}
@using (Html.BeginForm (null, null, FormMethod.Post, new { id = "__AjaxAntiForgeryForm" })){@(Html.AntiForgeryToken ())}
<input type="hidden" id="chapterId" name="chapterId" value="@(Model.Id)" />
<input type="hidden" id="editPassId" name="editPassId" />
<input type="hidden" id="editEntryId" name="editEntryId">
<input type="hidden" id="subBookId" name="subBookId" value="@(Model.SubBook.Id)" />
<div id="cd-nav"><a href="javascript:void(0)" class="cd-nav-trigger">Menu<span></span></a></div>
<div class="sdw-panel">
   <div class="title">Edit Passages</div>
   <div class="content">
      <div class="row">
         <div class="small-12 medium-4 large-4 columns hide-for-small-only" id="parentListContainer">
            <div class="sdw-panel" style="overflow: auto;" id="passageList">
               @foreach (var passage in Model.Passages) {
                  var len = passage.Text.Length > 20 ? 20 : passage.Text.Length;
                  <a href="javascript:void(0)" onclick="passage_get(@(passage.EntryId))" id="item_@(passage.EntryId)" class="sdw-button white expand small tLeft">
                     <small class="mLeft">@(passage.Number)</small> - @(passage.Text.Substring (0, len))...
                  </a>
               }
            </div>
         </div>
         <div class="small-12 medium-8 large-8 columns" id="workArea">
            <div class="row">
               <div class="small-9 medium-9 large-10 columns">
                  <label for="passHeader">Header</label>
                  <textarea id="passHeader" rows="2"></textarea>
               </div>
               <div class="small-3 medium-3 large-2 columns">
                  <a href="javascript:void(0)" class="sdw-button alt expand mTop" title="Edit Item" onclick="passage_edit_header();">
                     <i class="icon-edit"></i>
                  </a>
               </div>
            </div>
            <div class="row">
               <div class="small-12 columns">
                  <label for="passText">Text</label>
                  <textarea id="passText" name="passText" rows="8"></textarea>
               </div>
            </div>
            <div class="row">
               <div class="small-12 medium-6 large-6 columns">
                  <div class="row collapse">
                     <div class="small-5 large-4 columns">
                        <span class="prefix">Number</span>
                     </div>
                     <div class="small-7 large-8 columns">
                        <input type="number" id="entryNumber" name="entryNumber" value="0" />
                     </div>
                  </div>
               </div>
               <div class="small-12 medium-6 large-6 columns">
                  <div class="row collapse">
                     <div class="small-5 large-4 columns">
                        <span class="prefix">Order</span>
                     </div>
                     <div class="small-7 large-8 columns">
                        <input type="number" id="entryOrder" name="entryOrder" value="0" />
                     </div>
                  </div>
               </div>
            </div>
            <div class="row">
               <div class="small-6 columns">
                  <a href="javascript:void(0)" class="sdw-button reg expand small mBottom" onclick="passage_update();">
                     <i class="icon-savetodrive"></i> Save
                  </a>
               </div>
               <div class="small-6 columns">
                  <a href="javascript:void(0)" class="sdw-button err expand small mBottom" onclick="passage_check_delete();">
                     <i class="icon-trash"></i> Delete
                  </a>
               </div>
            </div>
            <div class="row">
               <div class="small-12 columns">
                  <div class="pagination">
                     <div class="row">
                        <div class="small-6 columns">
                           <a href="javascript:void(0)" class="page" onclick="passage_previous();">&laquo; Previous Item</a>
                        </div>
                        <div class="small-6 columns tRight">
                           <a href="javascript:void(0)" class="page" onclick="passage_next();">Next Item &raquo;</a>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</div>
<div class="sdw-panel" id="itemEditArea">
   <div class="title">Edit Item</div>
   <div class="content" id="editItem">
      
   </div>
</div>
<div class="sdw-panel">
   <div class="title">Chapter Details</div>
   <div class="content">
      <div class="row">
         <div class="small-9 medium-10 large-11 columns">
            <label for="chapterHeader">Header</label>
            <textarea id="chapterHeader" rows="2">@if(Model.Header != null){@(Model.Header.Text)}</textarea>
         </div>
         <div class="small-3 medium-2 large-1 columns">
            <a href="javascript:void(0)" class="sdw-button alt expand mTop" title="Edit Item" onclick="chapter_edit_header();">
               <i class="icon-edit"></i>
            </a>
         </div>
      </div>
      <div class="row">
         <div class="small-12 medium-6 large-6 columns">
            <label for="chapterName">Name</label>
            <input type="text" id="chapterName" value="@(Model.Name)" />
         </div>
         <div class="small-12 medium-6 large-6 columns">
            <label for="chapterOrder">Order</label>
            <input type="number" id="chapterOrder" value="@(Model.Order)" />
         </div>
      </div>
      <div class="row">
         <div class="small-12 medium-6 large-6 columns">
            <label for="chapterVisi">Visibility</label>
            <input id="chapterVisi" class="cmn-toggle cmn-toggle-yes-no expand" type="checkbox" @if (!Model.Hide) { <text> checked="checked" </text>  } />
            <label for="chapterVisi" data-on="Visible" data-off="Hidden"></label>
         </div>
         <div class="small-12 medium-6 large-6 columns">
            <label for="chapterReadMode">Reading Mode</label>
            <input id="chapterReadMode" class="cmn-toggle cmn-toggle-yes-no expand" type="checkbox" @if (!Model.DefaultToParagraph) { <text> checked="checked" </text>  } />
            <label for="chapterReadMode" data-on="Verse" data-off="Paragraph"></label>
         </div>
      </div>
      <div class="row">
         <div class="small-9 medium-10 large-11 columns">
            <label for="chapterFooter">Footer</label>
            <textarea id="chapterFooter" rows="2">@if(Model.Footer != null){@(Model.Footer.Text)}</textarea>
         </div>
         <div class="small-3 medium-2 large-1 columns">
            <a href="javascript:void(0)" class="sdw-button alt expand mTop" title="Edit Item" onclick="chapter_edit_footer();">
               <i class="icon-edit"></i>
            </a>
         </div>
      </div>
      <div class="row">
         <div class="small-12 medium-4 medium-offset-4 large-4 large-offset-4 columns">
            <a href="javascript:chapter_edit();" class="sdw-button reg expand">
               <i class="icon-edit"></i> update
            </a>
         </div>
      </div>
   </div>
</div>
@(Html.Partial("_AddEntries"))
@(Html.Partial ("_Modal"))
@section Scripts {
   @(Scripts.Render ("~/bundles/sdw.chapter"))
   @if (Model.Passages.Count > 0) {
      <script type="text/javascript">
         document.prevEntryId = -1;
         $(document).ready(function () {
            passage_get(@(Model.Passages.First().EntryId));
         });
      </script>
   }
}
